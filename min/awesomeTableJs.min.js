!function(e,t){"function"==typeof define&&define.amd?define(["awesomeTableJs"],t):e.awesomeTableJs=t(e.awesomeTableJs)}(this,function(){function e(e){this.globalOptions={url:"",data:"",pageSize:15,tableWrapper:"",paginationWrapper:"",searchboxWrapper:"",pageSizeWrapper:"",buildSearch:!0,buildPagination:!0,buildPageSize:!0,buildSorting:!0};for(var t in this.globalOptions)e.hasOwnProperty(t)&&(this.globalOptions[t]=e[t]);if(this.globalOptions.tableWrapper&&(this.tableWrapper=document.querySelector(this.globalOptions.tableWrapper)),this.globalOptions.searchboxWrapper&&(this.searchboxWrapper=document.querySelector(this.globalOptions.searchboxWrapper)),this.globalOptions.paginationWrapper&&(this.paginationWrapper=document.querySelector(this.globalOptions.paginationWrapper)),this.globalOptions.pageSizeWrapper&&(this.pageSizeWrapper=document.querySelector(this.globalOptions.pageSizeWrapper)),this.tableWrapper){var a=document.createElement("table");a.className="aweTbl-table",this.tableElement=a,this.tableWrapper.appendChild(a)}else{var n=document.createElement("DIV");n.className="aweTbl-table-wrapper";var a=document.createElement("table");a.className="aweTbl-table",this.tableElement=a,n.appendChild(a),document.body.appendChild(n)}if(!this.paginationWrapper){var n=document.createElement("DIV");n.className="aweTbl-pagination-wrapper",this.paginationWrapper=n,document.body.appendChild(n)}if(!this.pageSizeWrapper){var n=document.createElement("DIV");n.className="aweTbl-pageCount-wrapper",this.pageSizeWrapper=n,document.body.appendChild(n)}if(!this.searchboxWrapper){var n=document.createElement("DIV");n.className="aweTbl-searchBox-wrapper",this.searchboxWrapper=n,document.body.appendChild(n)}this.jsonKeys=[]}function t(e,t,a){var n=a?function(t){return a(t[e])}:function(t){return t[e]};return t=t?-1:1,function(e,a){return e=n(e),a=n(a),t*((e>a)-(a>e))}}function a(e,t){var a=Math.ceil(e/this.globalOptions.pageSize),n=document.querySelector(".aweTbl-pagination");n&&(n.innerHTML="");var i=n||document.createElement("Div");i.className="aweTbl-pagination";var r={first:{start:null,end:null,showDot:null},middle:{start:null,end:null},last:{start:null,end:null,showDot:null}};if(a>10){3>=t?(r.first.start="1",r.first.end="5",r.last.start=a-1,r.last.end=a,r.last.showDot=!0):4==t?(r.first.start="1",r.first.end="6",r.last.start=a-1,r.last.end=a,r.last.showDot=!0):5==t?(r.first.start="1",r.first.end="7",r.last.start=a-1,r.last.end=a,r.last.showDot=!0):t>5&&a-t>3?(r.first.start="1",r.first.end="2",r.first.showDot=!0,r.middle.start=t-2,r.middle.end=t+2,r.last.start=a-1,r.last.end=a,r.last.showDot=!0):3>=a-t&&(r.first.start="1",r.first.end="2",r.first.showDot=!0,r.last.start=t-5,r.last.end=a);for(var s=r.first.start;s<=r.first.end;s++){var l=document.createElement("a");l.className="aweTbl-pagination-label".concat(s==t?" currentPage ":""),l.innerHTML=s,l.href="javascript:void(0);",l.addEventListener("click",this.paging.bind(this,s),!1),i.appendChild(l)}if(r.first.showDot){var l=document.createElement("a");l.className="aweTbl-pagination-label",l.innerHTML="..",l.href="javascript:void(0);",i.appendChild(l)}if(r.middle.start)for(var s=r.middle.start;s<=r.middle.end;s++){var l=document.createElement("a");l.className="aweTbl-pagination-label".concat(s==t?" currentPage ":""),l.innerHTML=s,l.href="javascript:void(0);",l.addEventListener("click",this.paging.bind(this,s),!1),i.appendChild(l)}if(r.last.showDot){var l=document.createElement("a");l.className="aweTbl-pagination-label",l.innerHTML="..",l.href="javascript:void(0);",i.appendChild(l)}for(var s=r.last.start;s<=r.last.end;s++){var l=document.createElement("a");l.className="aweTbl-pagination-label".concat(s==t?" currentPage ":""),l.innerHTML=s,l.href="javascript:void(0);",l.addEventListener("click",this.paging.bind(this,s),!1),i.appendChild(l)}}else for(var s=1;a>=s;s++){var l=document.createElement("a");l.className="aweTbl-pagination-label",l.innerHTML=s,l.href="javascript:void(0);",l.addEventListener("click",this.paging.bind(this,s),!1),i.appendChild(l)}this.paginationWrapper.appendChild(i)}function n(){var e=document.createElement("DIV");e.className="aweTbl-searchBox";var t=document.createElement("input");t.type="text",t.className="aweTbl-searchBox-input",t.placeholder="write + ENTER",t.addEventListener("keydown",this.filter.bind(this,t),!1),e.appendChild(t),this.searchboxWrapper.appendChild(e)}function i(e){if(200!==e.status)throw"i cant use url response as json,check url and make sure that it will respond as json";var t=document.querySelector(".aweTbl-loading");t&&this.tableWrapper.removeChild(t);var i=JSON.parse(e.responseText);if(0==i.Length)throw"There is now recorde ro make a table with";sessionStorage.awesomeTabledata=e.responseText,l.call(this,i),this.globalOptions.buildPagination&&a.call(this,i.length,1),this.globalOptions.buildSearch&&n.call(this),this.globalOptions.buildPageSize&&r.call(this)}function r(){var e=document.createElement("select");e.className="aweTbl-pageSize";for(var t=1;5>=t;t++){var a=document.createElement("option");a.innerHTML=15*t,e.appendChild(a)}e.addEventListener("change",this.changePageSize.bind(this,""),!1),this.pageSizeWrapper.appendChild(e)}function s(e){var t=document.createElement("tbody"),a=e.length;if("object"==typeof e[0]){for(var n=this.jsonKeys.length,i=this.globalOptions.pageSize<a?this.globalOptions.pageSize:a,r=0;i>r;r++){var s=document.createElement("tr");for(j=0;j<n;j++){var l=document.createElement("td");l.innerHTML=e[r][this.jsonKeys[j]],s.appendChild(l)}t.appendChild(s)}var o=this.tableElement.querySelector("tbody");o&&this.tableElement.removeChild(o),this.tableElement.appendChild(t)}else{var s=document.createElement("tr"),l=document.createElement("td");l.colSpan=1e3,l.innerHTML="Nothing found :(",s.appendChild(l),t.appendChild(s);var o=this.tableElement.querySelector("tbody");o&&this.tableElement.removeChild(o),this.tableElement.appendChild(t)}}function l(e){var t=document.createElement("tbody"),a=e.length;if("object"==typeof e[0]){var n=document.createElement("thead");for(var i in e[0]){var r=document.createElement("th"),s=document.createElement("a");s.innerHTML=i,s.href="javascript:void(0);",s.setAttribute("data-sortKey",i),s.setAttribute("data-sortDirection","asc"),this.globalOptions.buildSorting&&s.addEventListener("click",this.sort.bind(this,s)),r.appendChild(s),this.jsonKeys.push(i),n.appendChild(r)}for(var l=this.jsonKeys.length,o=this.globalOptions.pageSize<a?this.globalOptions.pageSize:a,p=0;o>p;p++){var d=document.createElement("tr");for(j=0;j<l;j++){var c=document.createElement("td");c.innerHTML=e[p][this.jsonKeys[j]],d.appendChild(c)}t.appendChild(d)}var h=this.tableElement.querySelector("tbody");h&&this.tableElement.removeChild(h),this.tableElement.appendChild(n),this.tableElement.appendChild(t)}else console.log("string")}return e.prototype.createTable=function(){if(!this.globalOptions.url)throw"please pass a url ,becuase i want to create table from its json result";var e=this,t=new XMLHttpRequest;console.log(e," self");var a=document.createElement("div");a.innerHTML="   Loading ...  ",a.className="aweTbl-loading",this.tableWrapper.appendChild(a),t.addEventListener("load",i.bind(e,t)),t.addEventListener("error",function(){throw"requesting that url come with an error \n"+this.responseText}),t.addEventListener("abort",function(){throw"request canceled by you"}),t.open("GET",this.globalOptions.url),t.send()},e.prototype.paging=function(e){if(e){var t=parseInt(e);console.log(e)}else var t=1;if(sessionStorage.awesomeTabledata){var n=JSON.parse(sessionStorage.awesomeTabledata),i=n.length,r=(t-1)*this.globalOptions.pageSize,l=n.splice(r,this.globalOptions.pageSize);a.call(this,i,t),s.call(this,l)}else this.createTable()},e.prototype.filter=function(e){var t=e.value;if(sessionStorage.awesomeTabledata){var n=JSON.parse(sessionStorage.awesomeTabledata),i=[];console.log(t);for(var r=0,l=n.length;l>r;r++)for(var o=0,p=this.jsonKeys.length;p>o;o++)if(n[r][this.jsonKeys[o]].toString().match(t)){i.push(n[r]);break}s.call(this,i),a.call(this,i.length,1),console.log(i)}else this.createTable()},e.prototype.sort=function(e){var a=e.getAttribute("data-sortkey");a=a||this.jsonKeys[0];var n=e.getAttribute("data-sortDirection");if(n=n||"asc",console.log("dirextion : ",n," key : ",a),sessionStorage.awesomeTabledata){var i=JSON.parse(sessionStorage.awesomeTabledata);i.sort(t(a,"asc"==n,null)),sessionStorage.awesomeTabledata=JSON.stringify(i),s.call(this,i);for(var r=0,l=this.jsonKeys.length;l>r;r++)e.parentNode.parentNode.childNodes[r].childNodes[0].setAttribute("data-sortDirection","asc");e.setAttribute("data-sortDirection","asc"==n?"desc":"asc")}else this.createTable()},e.prototype.changePageSize=function(e){console.log(e);var t=parseInt(e,10);if(t>0)this.globalOptions.pageSize=t;else{var a=document.querySelector(".aweTbl-pageSize");this.globalOptions.pageSize=a?parseInt(a.value,10):15}this.paging(1)},e});
