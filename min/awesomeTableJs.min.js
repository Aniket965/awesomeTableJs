!function(e,t){"function"==typeof define&&define.amd?define(["awesomeTableJs"],t):e.awesomeTableJs=t(e.awesomeTableJs)}(this,function(){function e(e){if(this.globalOptions=e||{url:"",data:"",pageSize:15,tableWrapper:"",paginationWrapper:"",searchboxWrapper:"",pageSizeWrapper:""},this.globalOptions.tableWrapper&&(this.tableWrapper=document.querySelector(this.globalOptions.tableWrapper)),this.globalOptions.searchboxWrapper&&(this.searchboxWrapper=document.querySelector(this.globalOptions.searchboxWrapper)),this.globalOptions.paginationWrapper&&(this.paginationWrapper=document.querySelector(this.globalOptions.paginationWrapper)),this.globalOptions.pageSizeWrapper&&(this.pageSizeWrapper=document.querySelector(this.globalOptions.pageSizeWrapper)),this.tableWrapper){var t=document.createElement("table");t.className="aweTbl-table",this.tableElement=t,this.tableWrapper.appendChild(t)}else{var a=document.createElement("DIV");a.className="aweTbl-table-wrapper";var t=document.createElement("table");t.className="aweTbl-table",this.tableElement=t,a.appendChild(t),document.body.appendChild(a)}if(!this.paginationWrapper){var a=document.createElement("DIV");a.className="aweTbl-pagination-wrapper",this.paginationWrapper=a,document.body.appendChild(a)}if(!this.pageSizeWrapper){var a=document.createElement("DIV");a.className="aweTbl-pageCount-wrapper",this.pageSizeWrapper=a,document.body.appendChild(a)}if(!this.searchboxWrapper){var a=document.createElement("DIV");a.className="aweTbl-searchBox-wrapper",this.searchboxWrapper=a,document.body.appendChild(a)}this.jsonKeys=[]}function t(e,t,a){var n=a?function(t){return a(t[e])}:function(t){return t[e]};return t=t?-1:1,function(e,a){return e=n(e),a=n(a),t*((e>a)-(a>e))}}function a(e,t){var a=Math.ceil(e/this.globalOptions.pageSize),n=document.querySelector(".aweTbl-pagination");n&&(n.innerHTML="");var r=n||document.createElement("Div");r.className="aweTbl-pagination";var s={first:{start:null,end:null,showDot:null},middle:{start:null,end:null},last:{start:null,end:null,showDot:null}};if(a>10){3>=t?(s.first.start="1",s.first.end="5",s.last.start=a-1,s.last.end=a,s.last.showDot=!0):4==t?(s.first.start="1",s.first.end="6",s.last.start=a-1,s.last.end=a,s.last.showDot=!0):5==t?(s.first.start="1",s.first.end="7",s.last.start=a-1,s.last.end=a,s.last.showDot=!0):t>5&&a-t>3?(s.first.start="1",s.first.end="2",s.first.showDot=!0,s.middle.start=t-2,s.middle.end=t+2,s.last.start=a-1,s.last.end=a,s.last.showDot=!0):3>=a-t&&(s.first.start="1",s.first.end="2",s.first.showDot=!0,s.last.start=t-5,s.last.end=a);for(var i=s.first.start;i<=s.first.end;i++){var l=document.createElement("a");l.className="aweTbl-pagination-label".concat(i==t?" currentPage ":""),l.innerHTML=i,l.href="javascript:void(0);",l.addEventListener("click",this.paging.bind(this,i),!1),r.appendChild(l)}if(s.first.showDot){var l=document.createElement("a");l.className="aweTbl-pagination-label",l.innerHTML="..",l.href="javascript:void(0);",r.appendChild(l)}if(s.middle.start)for(var i=s.middle.start;i<=s.middle.end;i++){var l=document.createElement("a");l.className="aweTbl-pagination-label".concat(i==t?" currentPage ":""),l.innerHTML=i,l.href="javascript:void(0);",l.addEventListener("click",this.paging.bind(this,i),!1),r.appendChild(l)}if(s.last.showDot){var l=document.createElement("a");l.className="aweTbl-pagination-label",l.innerHTML="..",l.href="javascript:void(0);",r.appendChild(l)}for(var i=s.last.start;i<=s.last.end;i++){var l=document.createElement("a");l.className="aweTbl-pagination-label".concat(i==t?" currentPage ":""),l.innerHTML=i,l.href="javascript:void(0);",l.addEventListener("click",this.paging.bind(this,i),!1),r.appendChild(l)}}else for(var i=1;a>=i;i++){var l=document.createElement("a");l.className="aweTbl-pagination-label",l.innerHTML=i,l.href="javascript:void(0);",l.addEventListener("click",this.paging.bind(this,i),!1),r.appendChild(l)}this.paginationWrapper.appendChild(r)}function n(){var e=document.createElement("DIV");e.className="aweTbl-searchBox";var t=document.createElement("input");t.type="text",t.className="aweTbl-searchBox-input",t.placeholder="write + ENTER",t.addEventListener("keydown",this.filter.bind(this,t),!1),e.appendChild(t),this.searchboxWrapper.appendChild(e)}function r(e){if(200!==e.status)throw"i cant use url response as json,check url and make sure that it will respond as json";var t=JSON.parse(e.responseText);if(0==t.Length)throw"There is now recorde ro make a table with";sessionStorage.awesomeTabledata=e.responseText,l.call(this,t),a.call(this,t.length,1),n.call(this),s.call(this)}function s(){var e=document.createElement("select");e.className="aweTbl-pageSize";for(var t=1;5>=t;t++){var a=document.createElement("option");a.innerHTML=15*t,e.appendChild(a)}e.addEventListener("change",this.changePageSize.bind(this,""),!1),this.pageSizeWrapper.appendChild(e)}function i(e){var t=document.createElement("tbody"),a=e.length;if("object"==typeof e[0]){for(var n=this.jsonKeys.length,r=this.globalOptions.pageSize<a?this.globalOptions.pageSize:a,s=0;r>s;s++){var i=document.createElement("tr");for(j=0;j<n;j++){var l=document.createElement("td");l.innerHTML=e[s][this.jsonKeys[j]],i.appendChild(l)}t.appendChild(i)}var o=this.tableElement.querySelector("tbody");o&&this.tableElement.removeChild(o),this.tableElement.appendChild(t)}else{var i=document.createElement("tr"),l=document.createElement("td");l.colSpan=1e3,l.innerHTML="Nothing found :(",i.appendChild(l),t.appendChild(i);var o=this.tableElement.querySelector("tbody");o&&this.tableElement.removeChild(o),this.tableElement.appendChild(t)}}function l(e){var t=document.createElement("tbody"),a=e.length;if("object"==typeof e[0]){var n=document.createElement("thead");for(var r in e[0]){var s=document.createElement("th"),i=document.createElement("a");i.innerHTML=r,i.href="javascript:void(0);",i.setAttribute("data-sortKey",r),i.setAttribute("data-sortDirection","asc"),i.addEventListener("click",this.sort.bind(this,i)),s.appendChild(i),this.jsonKeys.push(r),n.appendChild(s)}for(var l=this.jsonKeys.length,o=this.globalOptions.pageSize<a?this.globalOptions.pageSize:a,p=0;o>p;p++){var d=document.createElement("tr");for(j=0;j<l;j++){var c=document.createElement("td");c.innerHTML=e[p][this.jsonKeys[j]],d.appendChild(c)}t.appendChild(d)}var h=this.tableElement.querySelector("tbody");h&&this.tableElement.removeChild(h),this.tableElement.appendChild(n),this.tableElement.appendChild(t)}else console.log("string")}return e.prototype.createTable=function(){if(!this.globalOptions.url)throw"please pass a url ,becuase i want to create table from its json result";var e=this,t=new XMLHttpRequest;console.log(e," self"),t.addEventListener("load",r.bind(e,t)),t.addEventListener("error",function(){throw"requesting that url come with an error \n"+this.responseText}),t.addEventListener("abort",function(){throw"request canceled by you"}),t.open("GET",this.globalOptions.url),t.send()},e.prototype.paging=function(e){if(e){var t=parseInt(e);console.log(e)}else var t=1;if(sessionStorage.awesomeTabledata){var n=JSON.parse(sessionStorage.awesomeTabledata),r=n.length,s=(t-1)*this.globalOptions.pageSize,l=n.splice(s,this.globalOptions.pageSize);a.call(this,r,t),i.call(this,l)}else this.createTable()},e.prototype.filter=function(e){var t=e.value;if(sessionStorage.awesomeTabledata){var n=JSON.parse(sessionStorage.awesomeTabledata),r=[];console.log(t);for(var s=0,l=n.length;l>s;s++)for(var o=0,p=this.jsonKeys.length;p>o;o++)if(n[s][this.jsonKeys[o]].toString().match(t)){r.push(n[s]);break}i.call(this,r),a.call(this,r.length,1),console.log(r)}else this.createTable()},e.prototype.sort=function(e){var a=e.getAttribute("data-sortkey");a=a||this.jsonKeys[0];var n=e.getAttribute("data-sortDirection");if(n=n||"asc",console.log("dirextion : ",n," key : ",a),sessionStorage.awesomeTabledata){var r=JSON.parse(sessionStorage.awesomeTabledata);r.sort(t(a,"asc"==n,null)),sessionStorage.awesomeTabledata=JSON.stringify(r),i.call(this,r),e.setAttribute("data-sortDirection","asc"==n?"desc":"asc")}else this.createTable()},e.prototype.changePageSize=function(e){console.log(e);var t=parseInt(e,10);if(t>0)this.globalOptions.pageSize=t;else{var a=document.querySelector(".aweTbl-pageSize");this.globalOptions.pageSize=a?parseInt(a.value,10):15}this.paging(1)},e});
