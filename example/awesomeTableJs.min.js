!function(e,t){"function"==typeof define&&define.amd?define(["awesomeTableJs"],t):e.awesomeTableJs=t(e.awesomeTableJs)}(this,function(){function e(e){this.globalOptions={url:"",data:"",pageSize:15,tableWrapper:"",paginationWrapper:"",searchboxWrapper:"",pageSizeWrapper:"",buildSearch:!0,buildPagination:!0,buildPageSize:!0,buildSorting:!0,columnsTypes:""};for(var t in this.globalOptions)e.hasOwnProperty(t)&&(this.globalOptions[t]=e[t]);if(this.globalOptions.tableWrapper&&(this.tableWrapper=document.querySelector(this.globalOptions.tableWrapper)),this.globalOptions.searchboxWrapper&&(this.searchboxWrapper=document.querySelector(this.globalOptions.searchboxWrapper)),this.globalOptions.paginationWrapper&&(this.paginationWrapper=document.querySelector(this.globalOptions.paginationWrapper)),this.globalOptions.pageSizeWrapper&&(this.pageSizeWrapper=document.querySelector(this.globalOptions.pageSizeWrapper)),this.tableWrapper){var a=document.createElement("table");a.className="aweTbl-table",this.tableElement=a,this.tableWrapper.appendChild(a)}else{var s=document.createElement("DIV");s.className="aweTbl-table-wrapper";var a=document.createElement("table");a.className="aweTbl-table",this.tableElement=a,s.appendChild(a),document.body.appendChild(s)}if(!this.paginationWrapper){var s=document.createElement("DIV");s.className="aweTbl-pagination-wrapper",this.paginationWrapper=s,document.body.appendChild(s)}if(!this.pageSizeWrapper){var s=document.createElement("DIV");s.className="aweTbl-pageCount-wrapper",this.pageSizeWrapper=s,document.body.appendChild(s)}if(!this.searchboxWrapper){var s=document.createElement("DIV");s.className="aweTbl-searchBox-wrapper",this.searchboxWrapper=s,document.body.appendChild(s)}this.jsonKeys=[]}function t(e){switch(typeof e){case"object":if(!Array.isArray(e))throw"pass an array with this format : [{'Name':'ronaldo',...},{'Name':'sarah'}]";e[0]&&(sessionStorage.awesomeTabledata=JSON.stringify(e),c.call(this,e),l.call(this,e.length));break;case"string":/^[\],:{}\s]*$/.test(e.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))}}function a(e,t,a){var s=a?function(t){return a(t[e])}:function(t){return t[e]};return t=t?-1:1,function(e,a){return e=s(e),a=s(a),t*((e>a)-(a>e))}}function s(e,t){var a=Math.ceil(e/this.globalOptions.pageSize),s=document.querySelector(".aweTbl-pagination");s&&(s.innerHTML="");var n=s||document.createElement("Div");n.className="aweTbl-pagination";var i={first:{start:null,end:null,showDot:null},middle:{start:null,end:null},last:{start:null,end:null,showDot:null}};if(a>10){3>=t?(i.first.start="1",i.first.end="5",i.last.start=a-1,i.last.end=a,i.last.showDot=!0):4==t?(i.first.start="1",i.first.end="6",i.last.start=a-1,i.last.end=a,i.last.showDot=!0):5==t?(i.first.start="1",i.first.end="7",i.last.start=a-1,i.last.end=a,i.last.showDot=!0):t>5&&a-t>3?(i.first.start="1",i.first.end="2",i.first.showDot=!0,i.middle.start=t-2,i.middle.end=t+2,i.last.start=a-1,i.last.end=a,i.last.showDot=!0):3>=a-t&&(i.first.start="1",i.first.end="2",i.first.showDot=!0,i.last.start=t-5,i.last.end=a);for(var l=i.first.start;l<=i.first.end;l++){var r=document.createElement("a");r.className="aweTbl-pagination-label".concat(l==t?" currentPage ":""),r.innerHTML=l,r.href="javascript:void(0);",r.addEventListener("click",this.paging.bind(this,l),!1),n.appendChild(r)}if(i.first.showDot){var r=document.createElement("a");r.className="aweTbl-pagination-label",r.innerHTML="..",r.href="javascript:void(0);",n.appendChild(r)}if(i.middle.start)for(var l=i.middle.start;l<=i.middle.end;l++){var r=document.createElement("a");r.className="aweTbl-pagination-label".concat(l==t?" currentPage ":""),r.innerHTML=l,r.href="javascript:void(0);",r.addEventListener("click",this.paging.bind(this,l),!1),n.appendChild(r)}if(i.last.showDot){var r=document.createElement("a");r.className="aweTbl-pagination-label",r.innerHTML="..",r.href="javascript:void(0);",n.appendChild(r)}for(var l=i.last.start;l<=i.last.end;l++){var r=document.createElement("a");r.className="aweTbl-pagination-label".concat(l==t?" currentPage ":""),r.innerHTML=l,r.href="javascript:void(0);",r.addEventListener("click",this.paging.bind(this,l),!1),n.appendChild(r)}}else for(var l=1;a>=l;l++){var r=document.createElement("a");r.className="aweTbl-pagination-label",r.innerHTML=l,r.href="javascript:void(0);",r.addEventListener("click",this.paging.bind(this,l),!1),n.appendChild(r)}this.paginationWrapper.appendChild(n)}function n(){var e=document.createElement("DIV");e.className="aweTbl-searchBox";var t=document.createElement("input");t.type="text",t.className="aweTbl-searchBox-input",t.placeholder="write + ENTER",t.addEventListener("keydown",this.filter.bind(this,t),!1),e.appendChild(t),this.searchboxWrapper.appendChild(e)}function i(e){if(200!==e.status)throw"i cant use url response as json,check url and make sure that it will respond as json";var t=document.querySelector(".aweTbl-loading");t&&this.tableWrapper.removeChild(t);var a=JSON.parse(e.responseText);if(0==a.Length)throw"There is now recorde ro make a table with";sessionStorage.awesomeTabledata=e.responseText,c.call(this,a),l.call(this,a.length)}function l(e){this.globalOptions.buildPagination&&s.call(this,e,1),this.globalOptions.buildSearch&&n.call(this),this.globalOptions.buildPageSize&&r.call(this)}function r(){var e=document.createElement("select");e.className="aweTbl-pageSize";for(var t=1;5>=t;t++){var a=document.createElement("option");a.innerHTML=15*t,e.appendChild(a)}e.addEventListener("change",this.changePageSize.bind(this,""),!1),this.pageSizeWrapper.appendChild(e)}function o(e){var t=document.createElement("tbody"),a=e.length;if("object"==typeof e[0]){var s=this.jsonKeys.length,n=this.globalOptions.pageSize<a?this.globalOptions.pageSize:a;if(this.globalOptions.columnsTypes)for(var i=0;n>i;i++){var l=document.createElement("tr");for(j=0;j<s;j++){var r=document.createElement("td");if(Object.keys(this.globalOptions.columnsTypes).indexOf(this.jsonKeys[j])>-1)switch(this.globalOptions.columnsTypes[this.jsonKeys[j]]){case"image":var o=document.createElement("img");o.src=e[i][this.jsonKeys[j]],o.alt=e[i][this.jsonKeys[j]],o.className="aweTbl-img-".concat(this.jsonKeys[j]),r.appendChild(o);break;case"link":var c=document.createElement("a");c.href=e[i][this.jsonKeys[j]],c.target="_blank",c.className="aweTbl-link-".concat(this.jsonKeys[j]),c.innerHTML=e[i][this.jsonKeys[j]],r.appendChild(c);break;default:r.className="aweTbl-text-".concat(this.jsonKeys[j]),r.innerHTML=e[i][this.jsonKeys[j]]}else r.className="aweTbl-text-".concat(this.jsonKeys[j]),r.innerHTML=e[i][this.jsonKeys[j]];l.appendChild(r)}t.appendChild(l)}else for(var i=0;n>i;i++){var l=document.createElement("tr");for(j=0;j<s;j++){var r=document.createElement("td");r.className="aweTbl-text-".concat(this.jsonKeys[j]),r.innerHTML=e[i][this.jsonKeys[j]],l.appendChild(r)}t.appendChild(l)}var p=this.tableElement.querySelector("tbody");p&&this.tableElement.removeChild(p),this.tableElement.appendChild(t)}else{var l=document.createElement("tr"),r=document.createElement("td");r.colSpan=1e3,r.innerHTML="Nothing found :(",l.appendChild(r),t.appendChild(l);var p=this.tableElement.querySelector("tbody");p&&this.tableElement.removeChild(p),this.tableElement.appendChild(t)}}function c(e){var t=document.createElement("tbody"),a=e.length;if("object"==typeof e[0]){var s=document.createElement("thead");for(var n in e[0]){var i=document.createElement("th"),l=document.createElement("a");l.innerHTML=n,l.href="javascript:void(0);",l.setAttribute("data-sortKey",n),l.setAttribute("data-sortDirection","asc"),this.globalOptions.buildSorting&&l.addEventListener("click",this.sort.bind(this,l)),i.appendChild(l),this.jsonKeys.push(n),s.appendChild(i)}var r=this.jsonKeys.length,o=this.globalOptions.pageSize<a?this.globalOptions.pageSize:a;if(this.globalOptions.columnsTypes)for(var c=0;o>c;c++){var p=document.createElement("tr");for(j=0;j<r;j++){var d=document.createElement("td");if(Object.keys(this.globalOptions.columnsTypes).indexOf(this.jsonKeys[j])>-1)switch(this.globalOptions.columnsTypes[this.jsonKeys[j]]){case"image":var h=document.createElement("img");h.src=e[c][this.jsonKeys[j]],h.alt=e[c][this.jsonKeys[j]],h.className="aweTbl-img-".concat(this.jsonKeys[j]),d.appendChild(h);break;case"link":var b=document.createElement("a");b.href=e[c][this.jsonKeys[j]],b.target="_blank",b.className="aweTbl-link-".concat(this.jsonKeys[j]),b.innerHTML=e[c][this.jsonKeys[j]],d.appendChild(b);break;default:d.className="aweTbl-text-".concat(this.jsonKeys[j]),d.innerHTML=e[c][this.jsonKeys[j]]}else d.className="aweTbl-text-".concat(this.jsonKeys[j]),d.innerHTML=e[c][this.jsonKeys[j]];p.appendChild(d)}t.appendChild(p)}else for(var c=0;o>c;c++){var p=document.createElement("tr");for(j=0;j<r;j++){var d=document.createElement("td");d.className="aweTbl-text-".concat(this.jsonKeys[j]),d.innerHTML=e[c][this.jsonKeys[j]],p.appendChild(d)}t.appendChild(p)}var m=this.tableElement.querySelector("tbody");m&&this.tableElement.removeChild(m),this.tableElement.appendChild(s),this.tableElement.appendChild(t)}else console.log("string")}return e.prototype.createTable=function(){if(this.globalOptions.data)t.call(this,this.globalOptions.data);else{if(!this.globalOptions.url)throw"please pass an url ,becuase i want to create table from its json result,or data like an array";var e=this,a=new XMLHttpRequest;console.log(e," self");var s=document.createElement("div");s.innerHTML="   Loading ...  ",s.className="aweTbl-loading",this.tableWrapper.appendChild(s),a.addEventListener("load",i.bind(e,a)),a.addEventListener("error",function(){throw"requesting that url come with an error \n"+this.responseText}),a.addEventListener("abort",function(){throw"request canceled by you"}),a.open("GET",this.globalOptions.url),a.send()}},e.prototype.paging=function(e){if(e){var t=parseInt(e);console.log(e)}else var t=1;if(sessionStorage.awesomeTabledata){var a=JSON.parse(sessionStorage.awesomeTabledata),n=a.length,i=(t-1)*this.globalOptions.pageSize,l=a.splice(i,this.globalOptions.pageSize);s.call(this,n,t),o.call(this,l)}else this.createTable()},e.prototype.filter=function(e){var t=e.value;if(sessionStorage.awesomeTabledata){var a=JSON.parse(sessionStorage.awesomeTabledata),n=[];console.log(t);for(var i=0,l=a.length;l>i;i++)for(var r=0,c=this.jsonKeys.length;c>r;r++)if(a[i][this.jsonKeys[r]].toString().match(t)){n.push(a[i]);break}o.call(this,n),s.call(this,n.length,1),console.log(n)}else this.createTable()},e.prototype.sort=function(e){var t=e.getAttribute("data-sortkey");t=t||this.jsonKeys[0];var s=e.getAttribute("data-sortDirection");if(s=s||"asc",console.log("dirextion : ",s," key : ",t),sessionStorage.awesomeTabledata){var n=JSON.parse(sessionStorage.awesomeTabledata);n.sort(a(t,"asc"==s,null)),sessionStorage.awesomeTabledata=JSON.stringify(n),o.call(this,n);for(var i=0,l=this.jsonKeys.length;l>i;i++)e.parentNode.parentNode.childNodes[i].childNodes[0].setAttribute("data-sortDirection","asc");e.setAttribute("data-sortDirection","asc"==s?"desc":"asc")}else this.createTable()},e.prototype.changePageSize=function(e){console.log(e);var t=parseInt(e,10);if(t>0)this.globalOptions.pageSize=t;else{var a=document.querySelector(".aweTbl-pageSize");a?this.globalOptions.pageSize=parseInt(a.value,10):this.globalOptions.pageSize=15}this.paging(1)},e});